import{r as l,m as k,h as U,j as c,B as V,n as q,V as B}from"./three-CTWSiUJi.js";import{G as F}from"./ground-Rhc0-MHq.js";import{d as J,u as L,C as X}from"./index-C4rnqq9n.js";import{e as Y,c as O,l as S}from"./easing-B4OZWJ3c.js";const T=({scalarTracker:w,nBoxes:e=5,gridSize:p=10,cellSize:o=.25})=>{const m=p,u=p,C=l.useMemo(()=>new J(.65,150,500),[250]),r=l.useRef(null),M=l.useMemo(()=>new k,[]),D=L(),R=X.getPalette(D).buildLut(),a=l.useMemo(()=>Array.from({length:e},s=>{const n=Math.floor(m*Math.random()),i=Math.floor(u*Math.random());return{fromRow:n,fromCol:i,toRow:n,toCol:i}}),[e,m,u]);return l.useEffect(()=>{if(r.current){for(let s=0;s<e;s++)r.current.setColorAt(s,R.getColor(s/(e-1)));r.current.instanceColor.needsUpdate=!0}},[R,e]),U(()=>{if(!r.current)return;if(C.step(w?.get()??0)){const[x,d]=Math.random()>.5?[!0,!1]:[!1,!0];for(let t=0;t<e;t++)a[t].fromRow=a[t].toRow,a[t].fromCol=a[t].toCol,x&&(a[t].toRow+=Math.random()>.5?1:-1),d&&(a[t].toCol+=Math.random()>.5?1:-1)}const s=Y(O(C.timeSinceLastEventMs/250)),n=S(Math.PI/4,3*Math.PI/4,s),i=-.5*o*Math.cos(n)/Math.sqrt(2),b=.5*o*Math.sin(n)/Math.sqrt(2);let g,j,P,I,v,f,h;for(const[x,{fromRow:d,fromCol:t,toRow:y,toCol:A}]of a.entries()){f=y-d,h=A-t;const E=d+f*(i+.5),G=t+h*(i+.5);f!==0&&M.makeRotationY((n-Math.PI/4)*f),h!==0&&M.makeRotationX(-(n-Math.PI/4)*h),g=E/(m-1),j=G/(u-1),P=m*o*(g-.5),I=u*o*(j-.5),v=b-o/4,M.setPosition(P,I,v),r.current.setMatrixAt(x,M)}r.current.instanceMatrix.needsUpdate=!0}),c.jsxs("instancedMesh",{ref:r,castShadow:!0,receiveShadow:!0,args:[new V,new q,e],children:[c.jsx("boxGeometry",{attach:"geometry",args:[o,o,o,1]}),c.jsx("meshBasicMaterial",{attach:"material",color:"white",toneMapped:!1})]})},W=({scalarTracker:w})=>c.jsxs(c.Fragment,{children:[c.jsx(T,{scalarTracker:w??{get:()=>Math.sin(.0025*Date.now())+1,set:()=>{}},nBoxes:200,gridSize:100,cellSize:1}),c.jsx(F,{position:new B(0,0,-1/2)})]});export{W as default};
