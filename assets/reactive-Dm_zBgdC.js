import{r as e,V as R,j as o,M as C,h as Z,E as q,n as G,B as J,T as O,m as K,Q as $,o as X}from"./three-CTWSiUJi.js";import{u as ee,C as te,T as k,b as se,c as ne}from"./index-C4rnqq9n.js";import{a as oe,D as re,M as ae,w as ie,V as ce,E as ue,B as le,N as me}from"./Noise-Ud5rWmk2.js";const he=e.forwardRef(function({blendFunction:t,worldFocusDistance:c,worldFocusRange:h,focusDistance:a,focusRange:p,focalLength:n,bokehScale:g,resolutionScale:l,resolutionX:d,resolutionY:M,width:A,height:m,target:w,depthTexture:s,..._},D){const{camera:v}=e.useContext(oe),H=w!=null,b=e.useMemo(()=>{const B=new re(v,{blendFunction:t,worldFocusDistance:c,worldFocusRange:h,focusDistance:a,focusRange:p,focalLength:n,bokehScale:g,resolutionScale:l,resolutionX:d,resolutionY:M,width:A,height:m});H&&(B.target=new R),s&&B.setDepthTexture(s.texture,s.packing);const I=B.maskPass;return I.maskFunction=ae.MULTIPLY_RGB_SET_ALPHA,B},[v,t,c,h,a,p,n,g,l,d,M,A,m,H,s]);return e.useEffect(()=>()=>{b.dispose()},[b]),o.jsx("primitive",{..._,ref:D,object:b,target:w})}),fe=ie(ce),pe=r=>(r%k+k)%k;class Q extends X{helixLength;helixRadius;helixWindingSeparation;helixStartingAngleRad;constructor(t,c,h,a=0){super(),this.helixLength=t,this.helixRadius=c,this.helixWindingSeparation=h,this.helixStartingAngleRad=pe(a)}getPoint(t,c=new R){t-=.5;const a=1/(this.helixLength/this.helixWindingSeparation),p=k*(t%a/a),n=this.helixRadius*Math.cos(p+this.helixStartingAngleRad),g=this.helixRadius*Math.sin(p+this.helixStartingAngleRad),l=this.helixLength*t;return c.set(n,g,l)}}const xe=(r,t)=>Math.hypot(r*Math.sin(t),r*Math.cos(t)-r),F=e.forwardRef(({coordinateMapper:r,helixLength:t=10,helixWindingSeparation:c=10,helixRadius:h=1,strandRadius:a=.1,baseSpacing:p=.35,strandOffsetRad:n=Math.PI/2,mirrorEffects:g=!0,fixedBaseGap:l=!0,...d},M)=>{const A=ee(),m=te.getPalette(A).buildLut(),w=Math.floor(t/p),s=e.useRef(null),_=e.useMemo(()=>new G({color:"#606060"}),[]),D=e.useMemo(()=>{const i=.45*xe(h,n),x=new J(a,a,i,1);for(let f=0;f<x.attributes.position.count;f++)x.attributes.position.setZ(f,x.attributes.position.getZ(f)-i/2);return x.attributes.position.needsUpdate=!0,x},[h,a,n]),v=e.useRef(null),H=e.useRef(null),b=e.useMemo(()=>new G({color:m.getColor(.5)}),[m]),[B,I,N,Y]=e.useMemo(()=>{const S=new Q(t,h,c,0),i=new Q(t,h,c,n);return[S,new O(S,100,a,12,!1),i,new O(i,100,a,12,!1)]},[t,h,c,a,n]),u=e.useMemo(()=>new K,[]),P=e.useMemo(()=>new R,[]),E=e.useMemo(()=>new R,[]),y=e.useMemo(()=>new R,[]),T=e.useMemo(()=>new $,[]),L=e.useMemo(()=>new R(0,0,1),[]);return e.useEffect(()=>{if(!s.current)return;let S=0;for(let i=0;i<w;i++){S=i/Math.max(w-1,1);const x=Math.floor(3.99*C.seededRandom(i)),f=3-x;B.getPoint(S,P),N.getPoint(S,E),u.setPosition(P),u.lookAt(P,E,L),s.current.setMatrixAt(i*2,u),s.current.setColorAt(i*2,m.getColor(x/3)),u.setPosition(E),u.lookAt(E,P,L),s.current.setMatrixAt(i*2+1,u),s.current.setColorAt(i*2+1,m.getColor(f/3))}s.current.instanceMatrix.needsUpdate=!0,s.current.instanceColor.needsUpdate=!0},[B,N,s,w,m,u,P,E,L]),Z(({clock:S})=>{if(!s.current)return;const i=S.getElapsedTime();let x=0,f=0,z=0,U=0;const V=.25,W=1;for(let j=0;j<w;j++)x=j/Math.max(w-1,1),f=r.map(se.CARTESIAN_1D,g?2*Math.abs(x-.5):x,0,0,i)/r.amplitude,f=(1+f)/2,z=V+(l?2*f:f)*(W-V),U=l?V+2*(1-f)*(W-V):z,s.current.getMatrixAt(j*2,u),u.decompose(P,T,y),y.z=z,u.compose(P,T,y),s.current.setMatrixAt(j*2,u),s.current.getMatrixAt(j*2+1,u),u.decompose(E,T,y),y.z=U,u.compose(E,T,y),s.current.setMatrixAt(j*2+1,u);s.current.instanceMatrix.needsUpdate=!0}),o.jsxs("group",{...d,ref:M,children:[o.jsx("mesh",{ref:v,geometry:I,material:b,castShadow:!0,receiveShadow:!0}),o.jsx("mesh",{ref:H,geometry:Y,material:b,castShadow:!0,receiveShadow:!0}),o.jsx("instancedMesh",{ref:s,args:[D,_,2*w],castShadow:!0,receiveShadow:!0})]})});F.displayName="BaseDoubleHelix";const ge=r=>{const t=[e.useRef(null),e.useRef(null),e.useRef(null),e.useRef(null),e.useRef(null)],c=t.length,h=15,a=Array.from({length:c}).map((p,n)=>new R().fromArray(Array.from({length:3}).map((g,l)=>2*C.seededRandom(n+l)-1)).normalize().multiplyScalar(h));return Z(({clock:p})=>{const n=p.getElapsedTime(),g=5e-4,l=.05;let d,M=0;t.forEach((A,m)=>{A.current&&(d=a[m],M=Math.sin(l*(.5+.5*C.seededRandom(m))*n+C.seededRandom(m)/l),A.current.position.set(d.x*M,d.y*M,d.z*M),A.current.rotation.z+=g*Math.cos((.5+.5*C.seededRandom(m))*n),A.current.rotation.y+=g*Math.cos((.5+.5*C.seededRandom(m))*n))})}),o.jsx(o.Fragment,{children:t.map((p,n)=>o.jsx(F,{ref:p,position:a[n],rotation:new q(...Array.from({length:3}).map((g,l)=>Math.PI*(2*C.seededRandom(n+l)-1))),...r},n))})},{useParams:de,useActions:Be}=ne({default:{multi:!0,helixLength:50,helixRadius:1,helixWindingSeparation:10,strandRadius:.1,baseSpacing:.35,strandOffsetRad:Math.PI/2,mirrorEffects:!0,fixedBaseGap:!1}}),Me=({coordinateMapper:r})=>{const{multi:t,...c}=de();return t?o.jsx(ge,{coordinateMapper:r,...c}):o.jsx(F,{coordinateMapper:r,...c})},Pe=r=>o.jsxs(o.Fragment,{children:[o.jsx(Me,{...r}),o.jsxs(ue,{children:[o.jsx(he,{focusDistance:0,focalLength:.02,bokehScale:3,height:480}),o.jsx(le,{luminanceThreshold:0,luminanceSmoothing:.9,height:300}),o.jsx(me,{opacity:.02}),o.jsx(fe,{eskil:!1,offset:.1,darkness:1.1})]})]});export{Pe as default,Be as useActions,de as useParams};
