import{r as n,ac as O,j as e,ad as v,h as E,m as b,V as M,Q as D,ae as L,B as N,af as F}from"./three-DoDmUXEH.js";import{u as j,C,b as G}from"./index-DTAMNN3q.js";import{e as V,E as Q}from"./easing-B4OZWJ3c.js";const U="/r3f-audio-visualizer/assets/horse-DMamucGr.png",B=a=>{const d=n.useRef(null),{nodes:l,animations:p}=O(U),f=j(),t=C.getPalette(f).buildLut(),c=n.useMemo(()=>e.jsx("meshStandardMaterial",{color:t.getColor(.5),flatShading:!0}),[t]),{actions:s}=v(p,d);return n.useEffect(()=>{var r;(r=s==null?void 0:s.horse_A_)==null||r.play()}),E(({clock:r})=>{var m;const u=r.getElapsedTime(),g=(Math.sin(.5*u)+1)/2;(m=s==null?void 0:s.horse_A_)==null||m.setEffectiveTimeScale(g)}),e.jsx("group",{ref:d,scale:[.025,.025,.025],rotation:[Math.PI/2,Math.PI,0],dispose:null,children:e.jsxs("group",{name:"AuxScene",children:[e.jsx("pointLight",{position:[10,100,200],intensity:100}),e.jsx("mesh",{name:"mesh_0",castShadow:!0,receiveShadow:!0,geometry:l.mesh_0.geometry,morphTargetDictionary:l.mesh_0.morphTargetDictionary,morphTargetInfluences:l.mesh_0.morphTargetInfluences,children:c})]})})},H=[[-1,1],[-.75,-.1],[-.6,0],[0,0],[.6,0],[.75,-.1],[1,1]],W=({nStones:a=30,stoneWidth:d=5,stoneHeight:l=.1,stoneLength:p=1,coordinateMapper:f})=>{const t=n.useRef(null),[c,s,r,u]=n.useMemo(()=>[new b,new M,new D,new M],[]),w=n.useMemo(()=>new L(H.map(i=>new M(0,i[0],i[1]).multiplyScalar(10)),!1,"catmullrom",.1),[]),g=j(),m=C.getPalette(g).buildLut();return n.useEffect(()=>{if(t.current){for(let o=0;o<a;o++)t.current.setColorAt(o,m.getColor(o/(a-1)));t.current.instanceColor.needsUpdate=!0}},[t,m,a]),E(({clock:o})=>{if(!t.current)return;const i=o.getElapsedTime(),S=.025,A=.5,T=S*(i-Math.cos(A*i)/A)%1,_=1-V(T,Q.LINEAR);for(let h=0;h<a;h++){const x=(_+h/a)%1,I=1-2*Math.abs(x-.5),P=Math.abs(x-.5),y=.5+f.map(G.CARTESIAN_1D,P,i)/2,R=I*(1+y);t.current.getMatrixAt(h,c),c.decompose(s,r,u),w.getPointAt(x,s),u.set(R,1,1),c.compose(s,r,u),t.current.setMatrixAt(h,c)}t.current.instanceMatrix.needsUpdate=!0}),e.jsx(e.Fragment,{children:e.jsxs("instancedMesh",{ref:t,castShadow:!0,receiveShadow:!0,count:a,args:[new N,new F,a],children:[e.jsx("boxGeometry",{attach:"geometry",args:[d,p,l,1,1,1]}),e.jsx("meshStandardMaterial",{attach:"material",color:"white",toneMapped:!1})]})})},J=({...a})=>e.jsxs(e.Fragment,{children:[e.jsx(W,{...a}),e.jsx(B,{...a})]});export{J as default};
