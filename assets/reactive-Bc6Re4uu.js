var J=Object.defineProperty;var K=(s,e,n)=>e in s?J(s,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[e]=n;var v=(s,e,n)=>K(s,typeof e!="symbol"?e+"":e,n);import{r as t,V as R,j as a,M as C,h as Y,E as $,n as O,B as X,T as Q,m as ee,Q as te,o as se}from"./three-DoDmUXEH.js";import{u as ne,C as oe,T as _,b as re,c as ae}from"./index-DTAMNN3q.js";import{a as ie,D as ce,M as ue,w as le,V as me,E as he,B as fe,N as pe}from"./Noise-B-_Kp6Qz.js";const xe=t.forwardRef(function({blendFunction:e,worldFocusDistance:n,worldFocusRange:l,focusDistance:c,focusRange:m,focalLength:o,bokehScale:g,resolutionScale:h,resolutionX:d,resolutionY:M,width:A,height:f,target:w,depthTexture:r,...D},I){const{camera:H}=t.useContext(ie),T=w!=null,b=t.useMemo(()=>{const B=new ce(H,{blendFunction:e,worldFocusDistance:n,worldFocusRange:l,focusDistance:c,focusRange:m,focalLength:o,bokehScale:g,resolutionScale:h,resolutionX:d,resolutionY:M,width:A,height:f});T&&(B.target=new R),r&&B.setDepthTexture(r.texture,r.packing);const L=B.maskPass;return L.maskFunction=ue.MULTIPLY_RGB_SET_ALPHA,B},[H,e,n,l,c,m,o,g,h,d,M,A,f,T,r]);return t.useEffect(()=>()=>{b.dispose()},[b]),a.jsx("primitive",{...D,ref:I,object:b,target:w})}),ge=le(me),de=s=>(s%_+_)%_;class Z extends se{constructor(n,l,c,m=0){super();v(this,"helixLength");v(this,"helixRadius");v(this,"helixWindingSeparation");v(this,"helixStartingAngleRad");this.helixLength=n,this.helixRadius=l,this.helixWindingSeparation=c,this.helixStartingAngleRad=de(m)}getPoint(n,l=new R){n-=.5;const m=1/(this.helixLength/this.helixWindingSeparation),o=_*(n%m/m),g=this.helixRadius*Math.cos(o+this.helixStartingAngleRad),h=this.helixRadius*Math.sin(o+this.helixStartingAngleRad),d=this.helixLength*n;return l.set(g,h,d)}}const Me=(s,e)=>Math.hypot(s*Math.sin(e),s*Math.cos(e)-s),N=t.forwardRef(({coordinateMapper:s,helixLength:e=10,helixWindingSeparation:n=10,helixRadius:l=1,strandRadius:c=.1,baseSpacing:m=.35,strandOffsetRad:o=Math.PI/2,mirrorEffects:g=!0,fixedBaseGap:h=!0,...d},M)=>{const A=ne(),f=oe.getPalette(A).buildLut(),w=Math.floor(e/m),r=t.useRef(null),D=t.useMemo(()=>new O({color:"#606060"}),[]),I=t.useMemo(()=>{const i=.45*Me(l,o),x=new X(c,c,i,1);for(let p=0;p<x.attributes.position.count;p++)x.attributes.position.setZ(p,x.attributes.position.getZ(p)-i/2);return x.attributes.position.needsUpdate=!0,x},[l,c,o]),H=t.useRef(null),T=t.useRef(null),b=t.useMemo(()=>new O({color:f.getColor(.5)}),[f]),[B,L,U,q]=t.useMemo(()=>{const S=new Z(e,l,n,0),i=new Z(e,l,n,o);return[S,new Q(S,100,c,12,!1),i,new Q(i,100,c,12,!1)]},[e,l,n,c,o]),u=t.useMemo(()=>new ee,[]),P=t.useMemo(()=>new R,[]),E=t.useMemo(()=>new R,[]),y=t.useMemo(()=>new R,[]),V=t.useMemo(()=>new te,[]),z=t.useMemo(()=>new R(0,0,1),[]);return t.useEffect(()=>{if(!r.current)return;let S=0;for(let i=0;i<w;i++){S=i/Math.max(w-1,1);const x=Math.floor(3.99*C.seededRandom(i)),p=3-x;B.getPoint(S,P),U.getPoint(S,E),u.setPosition(P),u.lookAt(P,E,z),r.current.setMatrixAt(i*2,u),r.current.setColorAt(i*2,f.getColor(x/3)),u.setPosition(E),u.lookAt(E,P,z),r.current.setMatrixAt(i*2+1,u),r.current.setColorAt(i*2+1,f.getColor(p/3))}r.current.instanceMatrix.needsUpdate=!0,r.current.instanceColor.needsUpdate=!0},[B,U,r,w,f,u,P,E,z]),Y(({clock:S})=>{if(!r.current)return;const i=S.getElapsedTime();let x=0,p=0,F=0,W=0;const k=.25,G=1;for(let j=0;j<w;j++)x=j/Math.max(w-1,1),p=s.map(re.CARTESIAN_1D,g?2*Math.abs(x-.5):x,0,0,i)/s.amplitude,p=(1+p)/2,F=k+(h?2*p:p)*(G-k),W=h?k+2*(1-p)*(G-k):F,r.current.getMatrixAt(j*2,u),u.decompose(P,V,y),y.z=F,u.compose(P,V,y),r.current.setMatrixAt(j*2,u),r.current.getMatrixAt(j*2+1,u),u.decompose(E,V,y),y.z=W,u.compose(E,V,y),r.current.setMatrixAt(j*2+1,u);r.current.instanceMatrix.needsUpdate=!0}),a.jsxs("group",{...d,ref:M,children:[a.jsx("mesh",{ref:H,geometry:L,material:b,castShadow:!0,receiveShadow:!0}),a.jsx("mesh",{ref:T,geometry:q,material:b,castShadow:!0,receiveShadow:!0}),a.jsx("instancedMesh",{ref:r,args:[I,D,2*w],castShadow:!0,receiveShadow:!0})]})});N.displayName="BaseDoubleHelix";const Ae=s=>{const e=[t.useRef(null),t.useRef(null),t.useRef(null),t.useRef(null),t.useRef(null)],n=e.length,l=15,c=Array.from({length:n}).map((m,o)=>new R().fromArray(Array.from({length:3}).map((g,h)=>2*C.seededRandom(o+h)-1)).normalize().multiplyScalar(l));return Y(({clock:m})=>{const o=m.getElapsedTime(),g=5e-4,h=.05;let d,M=0;e.forEach((A,f)=>{A.current&&(d=c[f],M=Math.sin(h*(.5+.5*C.seededRandom(f))*o+C.seededRandom(f)/h),A.current.position.set(d.x*M,d.y*M,d.z*M),A.current.rotation.z+=g*Math.cos((.5+.5*C.seededRandom(f))*o),A.current.rotation.y+=g*Math.cos((.5+.5*C.seededRandom(f))*o))})}),a.jsx(a.Fragment,{children:e.map((m,o)=>a.jsx(N,{ref:m,position:c[o],rotation:new $(...Array.from({length:3}).map((g,h)=>Math.PI*(2*C.seededRandom(o+h)-1))),...s},o))})},{useParams:we,useActions:Ce}=ae({default:{multi:!0,helixLength:50,helixRadius:1,helixWindingSeparation:10,strandRadius:.1,baseSpacing:.35,strandOffsetRad:Math.PI/2,mirrorEffects:!0,fixedBaseGap:!1}}),Se=({coordinateMapper:s})=>{const{multi:e,...n}=we();return e?a.jsx(Ae,{coordinateMapper:s,...n}):a.jsx(N,{coordinateMapper:s,...n})},Re=s=>a.jsxs(a.Fragment,{children:[a.jsx(Se,{...s}),a.jsxs(he,{children:[a.jsx(xe,{focusDistance:0,focalLength:.02,bokehScale:3,height:480}),a.jsx(fe,{luminanceThreshold:0,luminanceSmoothing:.9,height:300}),a.jsx(pe,{opacity:.02}),a.jsx(ge,{eskil:!1,offset:.1,darkness:1.1})]})]});export{Re as default,Ce as useActions,we as useParams};
